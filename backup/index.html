<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Circle: Family Stories</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>The Circle: Family Stories</h1>
            <p class="tagline">Preserve your family memories for generations</p>
        </header>
        
        <!-- Profile Setup (shown first time) -->
        <div id="profile-setup" class="profile-setup" style="display: none;">
            <div class="setup-header">
                <h2>Welcome to The Circle</h2>
                <p class="welcome-text">Start by telling us about yourself to begin preserving your family stories.</p>
            </div>
            
            <div class="form-group">
                <label for="user-name"><i class="fas fa-user"></i> Your Name *</label>
                <input type="text" id="user-name" placeholder="Enter your full name">
            </div>
            
            <div class="form-group">
                <label for="birth-date"><i class="fas fa-calendar-alt"></i> Date of Birth *</label>
                <input type="date" id="birth-date">
            </div>
            
            <div class="form-group">
                <label for="family-role"><i class="fas fa-users"></i> Your Family Role *</label>
                <select id="family-role">
                    <option value="">Select your role</option>
                    <option value="parent">Parent</option>
                    <option value="grandparent">Grandparent</option>
                    <option value="child">Child</option>
                    <option value="sibling">Sibling</option>
                    <option value="cousin">Cousin</option>
                    <option value="spouse">Spouse</option>
                    <option value="other">Other</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="birth-place"><i class="fas fa-map-marker-alt"></i> Birth Place (Optional)</label>
                <input type="text" id="birth-place" placeholder="Where were you born?">
            </div>
            
            <div class="form-actions">
                <button onclick="saveProfile()" class="btn-primary">
                    <i class="fas fa-heart-circle-plus"></i> Join The Circle
                </button>
            </div>
        </div>
        
        <!-- Main Interface with Tabs -->
        <div class="tab-container" style="display: none;">
            <!-- Tab Navigation -->
            <nav class="tabs">
                <button class="tab active" onclick="showTab('capture', event)">
                    <i class="fas fa-plus-circle"></i> Share Memory
                </button>
                <button class="tab" onclick="showTab('timeline', event)">
                    <i class="fas fa-stream"></i> Timeline
                </button>
                <button class="tab" onclick="showTab('search', event)">
                    <i class="fas fa-search"></i> Search
                </button>
                <button class="tab" onclick="showTab('media', event)">
                    <i class="fas fa-images"></i> Media
                </button>
                <button class="tab" onclick="showTab('comments', event)">
                    <i class="fas fa-heart"></i> Love Notes
                </button>
                <button class="tab" onclick="showTab('export', event)">
                    <i class="fas fa-file-export"></i> Export
                </button>
            </nav>
            
            <!-- Capture Tab -->
            <div id="capture" class="tab-content active">
                <div class="tab-header">
                    <h2><i class="fas fa-plus-circle"></i> Share a Memory</h2>
                    <p class="tab-description">Write down a story from your life or family history</p>
                </div>
                
                <div class="capture-container">
                    <div class="prompt-suggestions">
                        <p>Need inspiration? Try:</p>
                        <div class="prompt-buttons">
                            <button onclick="suggestPrompt('childhood')" class="prompt-btn">
                                <i class="fas fa-child"></i> Childhood
                            </button>
                            <button onclick="suggestPrompt('family')" class="prompt-btn">
                                <i class="fas fa-users"></i> Family Story
                            </button>
                            <button onclick="suggestPrompt('travel')" class="prompt-btn">
                                <i class="fas fa-plane"></i> Travel Memory
                            </button>
                            <button onclick="suggestPrompt('first-job')" class="prompt-btn">
                                <i class="fas fa-briefcase"></i> First Job
                            </button>
                        </div>
                    </div>
                    
                    <textarea id="memory-text" placeholder="Write your memory here... What happened? Who was there? What made it special?" rows="8"></textarea>
                    
                    <div class="memory-meta">
                        <div class="meta-group">
                            <label for="memory-date"><i class="fas fa-calendar"></i> When did this happen?</label>
                            <input type="text" id="memory-date" placeholder="e.g., 1955, March 1975, Summer 1968">
                            <small class="hint">Year, season, or approximate date</small>
                        </div>
                    </div>
                    
                    <div class="capture-actions">
                        <button onclick="saveMemory()" class="btn-primary btn-large">
                            <i class="fas fa-save"></i> Save to Family Timeline
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Timeline Tab -->
            <div id="timeline" class="tab-content">
                <div class="tab-header">
                    <h2><i class="fas fa-stream"></i> Family Timeline</h2>
                    <p class="tab-description">All your family memories in chronological order</p>
                </div>
                
                <div class="timeline-controls">
                    <div class="search-box">
                        <input type="text" id="timeline-search" placeholder="Search memories...">
                        <button onclick="searchTimeline()" class="btn-secondary">
                            <i class="fas fa-search"></i> Search
                        </button>
                        <button onclick="clearTimelineSearch()" class="btn-secondary">
                            <i class="fas fa-times"></i> Clear
                        </button>
                    </div>
                </div>
                
                <div id="timeline-content">
                    <!-- Memories will be loaded here -->
                    <div class="loading">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Loading family timeline...</p>
                    </div>
                </div>
            </div>
            
            <!-- Search Tab -->
            <div id="search" class="tab-content">
                <div class="tab-header">
                    <h2><i class="fas fa-search"></i> Search Family Memories</h2>
                    <p class="tab-description">Ask natural questions about your family history</p>
                </div>
                
                <div class="search-container">
                    <div class="search-box search-box-large">
                        <input type="text" id="search-query" placeholder="Ask a question... e.g., Where was Jon Stiles born?">
                        <button onclick="performSmartSearch()" class="btn-primary">
                            <i class="fas fa-search"></i> Search
                        </button>
                    </div>
                    
                    <div class="search-examples">
                        <p>Try asking:</p>
                        <div class="example-queries">
                            <span class="example-tag" onclick="setSearchExample('Who was Peter Elgar?')">Who was Peter Elgar?</span>
                            <span class="example-tag" onclick="setSearchExample('Tell me about childhood memories')">Tell me about childhood memories</span>
                            <span class="example-tag" onclick="setSearchExample('What happened in 1975?')">What happened in 1975?</span>
                            <span class="example-tag" onclick="setSearchExample('Where did we live?')">Where did we live?</span>
                        </div>
                    </div>
                    
                    <div id="search-results">
                        <!-- Search results will be displayed here -->
                        <div class="empty-state">
                            <i class="fas fa-search fa-3x"></i>
                            <h3>Search Family Memories</h3>
                            <p>Ask a question about your family history using natural language.</p>
                            <p class="hint">For example: "Where was Jon Stiles born?" or "Tell me about model aircrafts"</p>
                        </div>
                    </div>
                </div>
            </div>
            
<!-- Media Tab -->
<div id="media" class="tab-content">
    <div class="tab-header">
        <h2><i class="fas fa-images"></i> Family Media</h2>
        <p class="tab-description">Photos, audio recordings, videos, and documents</p>
    </div>
    
    <div class="media-container">
        <!-- Messages will appear here -->
        
        <!-- Upload Section -->
        <div class="upload-section">
            <div id="media-drop-zone" class="drop-zone">
                <i class="fas fa-cloud-upload-alt"></i>
                <h3>Upload Media</h3>
                <p>Drag and drop files here or</p>
                <button id="media-upload-btn" class="btn-primary">
                    <i class="fas fa-upload"></i> Browse Files
                </button>
                <input type="file" id="media-file-input" multiple style="display: none;">
                <p class="help-text">Supports: Images, PDF, Audio, Video (Max 50MB each)</p>
            </div>
            
            <div id="media-preview" class="media-preview"></div>
            
            <form id="media-upload-form" style="display: none;" id="media-form-fields">
                <div class="form-group">
                    <label for="media-title">Title *</label>
                    <input type="text" id="media-title" placeholder="Enter a title for your media" required>
                </div>
                <div class="form-group">
                    <label for="media-description">Description (Optional)</label>
                    <textarea id="media-description" placeholder="Describe this media..."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="media-date">Date (Optional)</label>
                        <input type="date" id="media-date">
                    </div>
                    <div class="form-group">
                        <label for="media-year">Year (Optional)</label>
                        <input type="number" id="media-year" min="1900" max="2100" placeholder="Year">
                    </div>
                </div>
                <div class="form-group">
                    <label for="media-people">People (Optional)</label>
                    <input type="text" id="media-people" placeholder="Who is in this media?">
                </div>
                <button type="submit" class="btn btn-success">
                    <i class="fas fa-upload"></i> Upload Files
                </button>
            </form>
        </div>
        
        <!-- Gallery Section -->
        <div class="gallery-section">
            <h3><i class="fas fa-images"></i> Media Gallery</h3>
            <div id="media-gallery" class="media-gallery">
                <!-- Media items will be loaded here -->
                <div class="empty-gallery">
                    <i class="fas fa-images"></i>
                    <p>No media uploaded yet</p>
                    <p>Drag and drop files or click upload to add media</p>
                </div>
            </div>
        </div>
    </div>
</div>
            
            <!-- Comments/Love Notes Tab -->
            <div id="comments" class="tab-content">
                <div class="tab-header">
                    <h2><i class="fas fa-heart"></i> Love Notes</h2>
                    <p class="tab-description">Share gratitude and appreciation for family memories</p>
                </div>
                
                <div id="comments-content">
                    <div class="empty-state">
                        <i class="fas fa-comment-heart fa-3x"></i>
                        <h3>Share Your Gratitude</h3>
                        <p>Add love notes to family memories to express appreciation and connection.</p>
                        <button onclick="showTab('timeline')" class="btn-primary">
                            <i class="fas fa-heart"></i> Add Love Note
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Export Tab -->
            <div id="export" class="tab-content">
                <div class="tab-header">
                    <h2><i class="fas fa-file-export"></i> Export Memories</h2>
                    <p class="tab-description">Create PDFs to share with family members</p>
                </div>
                
                <div class="export-options">
                    <div class="export-card">
                        <div class="export-icon">
                            <i class="fas fa-book"></i>
                        </div>
                        <h3>Complete Story</h3>
                        <p>All memories in chronological order</p>
                        <button onclick="generatePDF('full')" class="btn-primary">
                            <i class="fas fa-download"></i> Generate Full PDF
                        </button>
                    </div>
                    
                    <div class="export-card">
                        <div class="export-icon">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <h3>Story Summary</h3>
                        <p>Key memories organized by category</p>
                        <button onclick="generatePDF('summary')" class="btn-primary">
                            <i class="fas fa-download"></i> Generate Summary
                        </button>
                    </div>
                    
                    <div class="export-card">
                        <div class="export-icon">
                            <i class="fas fa-photo-video"></i>
                        </div>
                        <h3>Family Album</h3>
                        <p>Memories with photos and media</p>
                        <button onclick="generateFamilyAlbum()" class="btn-primary">
                            <i class="fas fa-download"></i> Create Album
                        </button>
                    </div>
                </div>
                
                <div id="export-status" class="export-status"></div>
            </div>
        </div>
        
        <!-- Footer -->
        <footer>
            <div class="footer-content">
                <p>The Circle - Family Memory Preservation App</p>
                <p class="footer-info">Preserving stories for future generations</p>
            </div>
        </footer>
    </div>
    
    <!-- Load JavaScript modules -->
    <script src="/static/js/app.js"></script>
    <script src="/static/js/profile.js"></script>
    <script src="/static/js/timeline.js"></script>
    <script src="/static/js/search.js"></script>
    <script src="/static/js/capture.js"></script>
    <script src="/static/js/comments.js"></script>
    <script src="/static/js/export.js"></script>
    <script src="/static/js/media.js"></script>
    
    <!-- Declare global functions -->
    <script>
        // Make functions available globally
        window.saveProfile = saveProfile; //window.showTab = showTab; removed.
        window.performSmartSearch = performSmartSearch;
        window.loadMemories = loadMemories;
        window.addComment = addComment;
        window.viewMemory = viewMemory;
        window.saveMemory = saveMemory;
        window.suggestPrompt = suggestPrompt;
        window.searchTimeline = searchTimeline;
        window.clearTimelineSearch = clearTimelineSearch;
        window.generatePDF = generatePDF;
        window.generateFamilyAlbum = generateFamilyAlbum;
        window.setSearchExample = setSearchExample;
        
        // Helper functions
        function setSearchExample(example) {
            document.getElementById('search-query').value = example;
        }
        
        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            // Any additional initialization
        });
    </script>
</body>
</html>